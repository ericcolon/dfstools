<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Projecting a Season with mvglmmRank • dfstools</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Projecting a Season with mvglmmRank">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dfstools</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mvglmmranking.html">Projecting a Season with mvglmmRank</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/znmeb/dfstools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Projecting a Season with mvglmmRank</h1>
                        <h4 class="author">M. Edward (Ed) Borasky</h4>
            
            <h4 class="date">2018-07-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/znmeb/dfstools/blob/master/vignettes/mvglmmranking.Rmd"><code>vignettes/mvglmmranking.Rmd</code></a></small>
      <div class="hidden name"><code>mvglmmranking.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h2>
<ol style="list-style-type: decimal">
<li>You’ll need an API key for Stattleship. Go to <a href="https://www.patreon.com/stattleship/posts" class="uri">https://www.patreon.com/stattleship/posts</a> to sign up.</li>
<li>If you haven’t already, install <code>devtools</code>:<code>install.packages("devtools")</code>.</li>
<li>Install <code>dfstools</code>: <code><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">devtools::install_github("znmeb/dfstools", build_vignettes = TRUE)</a></code>.</li>
</ol>
</div>
<div id="setting-the-api-access-token" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-the-api-access-token" class="anchor"></a>Setting the API access token</h2>
<ol style="list-style-type: decimal">
<li>Go to the Stattleship API page <a href="https://api.stattleship.com/" class="uri">https://api.stattleship.com/</a> and sign in. Then press the <code>Copy Access Token</code> button.</li>
<li>
<p>Enter the following in the R console:</p>
<pre><code>token &lt;- "paste_the_copied_access_token_here"
library(dfstools)
stattleshipR::set_token(token)</code></pre>
</li>
</ol>
</div>
<div id="downloading-the-games-tibble" class="section level2">
<h2 class="hasAnchor">
<a href="#downloading-the-games-tibble" class="anchor"></a>Downloading the <code>games</code> tibble</h2>
<ol style="list-style-type: decimal">
<li>Choose your league. I’m going to use NBA.</li>
<li>Acquire the <code>games</code> tibble: <code>nba_games &lt;- get_games("nba")</code>.</li>
</ol>
<p>This will return a tibble of the games in the season, both already played and upcoming. Column <code>status</code> will be “upcoming” for upcoming games and “closed” for games that have been played.</p>
</div>
<div id="projecting-the-rest-of-the-season" class="section level2">
<h2 class="hasAnchor">
<a href="#projecting-the-rest-of-the-season" class="anchor"></a>Projecting the rest of the season</h2>
<ol style="list-style-type: decimal">
<li>
<p>Run the projections: <code>nba_result &lt;- project_upcoming_games(nba_games)</code>. You’ll see the iterations for the <code>mvglmmRank</code> model. This will take some time, depending on the number of games in the input dataset.</p>
<p>The result of <code>project_upcoming_games</code> is a list of three items:</p>
<ul>
<li>projections: a tibble containing the projections,</li>
<li>model: the model <code>mvglmmRank</code> derived, and</li>
<li>model_input: the data from closed games that <code>mvglmmRank</code> used.</li>
</ul>
</li>
<li>Extract the projections from the result: <code>nba_projections &lt;- nba_result$projections</code>.</li>
<li><p>Save as a CSV file: <code><a href="http://www.rdocumentation.org/packages/readr/topics/write_delim">readr::write_excel_csv(nba_projections, "nba_projections.csv")</a></code>.</p></li>
</ol>
</div>
<div id="the-whole-thing-to-copy-and-paste" class="section level2">
<h2 class="hasAnchor">
<a href="#the-whole-thing-to-copy-and-paste" class="anchor"></a>The whole thing to copy and paste</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(dfstools)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">stattleshipR<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stattleshipR/topics/set_token">set_token</a></span>(token)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">nba_games &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_games.html">get_games</a></span>(<span class="st">"nba"</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">nba_result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_upcoming_games.html">project_upcoming_games</a></span>(nba_games)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">nba_projections &lt;-<span class="st"> </span>nba_result<span class="op">$</span>projections</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">readr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/readr/topics/write_delim">write_excel_csv</a></span>(nba_projections, <span class="st">"nba_projections.csv"</span>)</a></code></pre></div>
</div>
<div id="faq" class="section level2">
<h2 class="hasAnchor">
<a href="#faq" class="anchor"></a>FAQ</h2>
<div id="what-do-the-projections-columns-mean" class="section level3">
<h3 class="hasAnchor">
<a href="#what-do-the-projections-columns-mean" class="anchor"></a>What do the <code>projections</code> columns mean?</h3>
<ul>
<li>away: The away team name</li>
<li>home: the home team name</li>
<li>prob_away_wins: the projected probability that the away team wins</li>
<li>prob_home_wins: the projected probability that the home team wins</li>
<li>away_score_proj: the projected score for the away team</li>
<li>home_score_proj: the projected score for the home team</li>
<li>home_mov_proj: the projected margin of victory for the home team</li>
<li>total_proj: the projected total of both teams’ scores</li>
<li>entropy: the projected Shannon entropy for the game</li>
<li>scheduled_at: the scheduled game start time</li>
<li>neutral_site: 1 if the game is scheduled at a neutral site</li>
<li>method: The method used to build the <code>mvglmmRank</code> model; the default is “PB1”.</li>
</ul>
<p>The (Shannon) entropy is a measure of information - how much we stand to learn about the teams from the outcome of the game. It’s an indicator of the projected closeness of the game. The maximum value, 1.0, indicates that the game is projected to be a tie and we’ll learn a lot from the outcome.</p>
<p>A minimum entropy, zero, indicates that the game will be a blowout. There’s little we can learn; they might as well just give the game to the favorite and avoid injury risk. ;-) I’ve never seen a zero; the lowest value of the entropy projections for the upcoming NBA season as of December 26, 2017 is Hawks at Warriors, coming up on 2018-03-23, with a projected entropy of 0.39. The model predicts that there’s a 92% probability that the Warriors will win.</p>
</div>
<div id="how-good-are-the-projections" class="section level3">
<h3 class="hasAnchor">
<a href="#how-good-are-the-projections" class="anchor"></a>How good are the projections?</h3>
<p>They’re about as good as you can get given the inputs are just the scores of completed games. They won’t be as good as projections that take into account more detailed information from compeleted games.</p>
<p>They won’t be as good as a simulation. And they won’t be as good as closing odds / point spreads / totals from bookmakers, which account for late-breaking player status and the “wisdom of the crowd”. Bottom line: don’t risk money on these numbers. I only use them as inputs for projecting player fantasy points.</p>
</div>
<div id="sample-output" class="section level3">
<h3 class="hasAnchor">
<a href="#sample-output" class="anchor"></a>Sample output</h3>
<p>I’ve uploaded a sample I ran on December 26, 2017 to <a href="https://docs.google.com/spreadsheets/d/1oy0I_zm92JNrEeMjABXR489LbylT3zI2EwExCPHouMQ/edit?usp=sharing" class="uri">https://docs.google.com/spreadsheets/d/1oy0I_zm92JNrEeMjABXR489LbylT3zI2EwExCPHouMQ/edit?usp=sharing</a>.</p>
</div>
<div id="where-can-i-find-details-on-mvglmmrank" class="section level3">
<h3 class="hasAnchor">
<a href="#where-can-i-find-details-on-mvglmmrank" class="anchor"></a>Where can I find details on <code>mvglmmRank</code>?</h3>
<p>The package documentation is at <span class="citation">Karl and Broatch (2015)</span>, but there’s not a lot of the mathematics there. <span class="citation">Broatch and Karl (2017)</span> gives the math and references earlier papers with more details.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Broatch2017">
<p>Broatch, Jennifer E., and Andrew T. Karl. 2017. “Multivariate Generalized Linear Mixed Models for Joint Estimation of Sporting Outcomes.” <a href="https://arxiv.org/abs/1710.05284" class="uri">https://arxiv.org/abs/1710.05284</a>.</p>
</div>
<div id="ref-Karl2015">
<p>Karl, Andrew T., and Jennifer Broatch. 2015. <em>MvglmmRank: Multivariate Generalized Linear Mixed Models for Ranking Sports Teams</em>. <a href="https://CRAN.R-project.org/package=mvglmmRank" class="uri">https://CRAN.R-project.org/package=mvglmmRank</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#getting-started">Getting started</a></li>
      <li><a href="#setting-the-api-access-token">Setting the API access token</a></li>
      <li><a href="#downloading-the-games-tibble">Downloading the <code>games</code> tibble</a></li>
      <li><a href="#projecting-the-rest-of-the-season">Projecting the rest of the season</a></li>
      <li><a href="#the-whole-thing-to-copy-and-paste">The whole thing to copy and paste</a></li>
      <li><a href="#faq">FAQ</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by M. Edward (Ed) Borasky.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
