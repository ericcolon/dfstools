<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="M. Edward (Ed) Borasky" />

<meta name="date" content="2017-12-25" />

<title>Projecting a Season with mvglmmRank</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Projecting a Season with mvglmmRank</h1>
<h4 class="author"><em>M. Edward (Ed) Borasky</em></h4>
<h4 class="date"><em>2017-12-25</em></h4>



<section id="getting-started" class="level2">
<h2>Getting started</h2>
<ol type="1">
<li>You will need an API key for Stattleship. Go to <a href="https://www.patreon.com/stattleship/posts" class="uri">https://www.patreon.com/stattleship/posts</a> to sign up.</li>
<li>If you haven’t already, install the <code>devtools</code> package via <code>install.packages(&quot;devtools&quot;)</code>.</li>
<li>Install <code>tidysportsfeeds</code>: <code>devtools::install_github(&quot;znmeb/tidysportsfeeds&quot;, build_vignettes = TRUE)</code>.</li>
</ol>
</section>
<section id="setting-the-api-access-token" class="level2">
<h2>Setting the API access token</h2>
<ol type="1">
<li>Go to the Stattleship API page <a href="https://api.stattleship.com/" class="uri">https://api.stattleship.com/</a> and sign in. Then press the <code>Copy Access Token</code> button.</li>
<li><p>Enter the following in the R console:</p>
<pre><code>library(tidysportsfeeds)
library(stattleshipR)
set_token(&quot;paste_the_copied_access_token_here&quot;)</code></pre></li>
</ol>
</section>
<section id="downloading-the-current-season-for-a-league" class="level2">
<h2>Downloading the current season for a league</h2>
<ol type="1">
<li>Choose your league. I’m going to use NBA.</li>
<li>Acquire the data frame: <code>nba_season &lt;- get_games(&quot;nba&quot;)</code>.</li>
</ol>
<p>This will return a tibble of all the games in the season, both already played and upcoming. Column <code>status</code> will be “upcoming” for upcoming games and “closed” for games that have been played.</p>
</section>
<section id="predicting-the-rest-of-the-season" class="level2">
<h2>Predicting the rest of the season</h2>
<ol type="1">
<li>Build the model: `nba_model &lt;- build_model(nba_season)’.</li>
<li>Run the predictions: <code>nba_predictions &lt;- game_predict(nba_model, nba_season)</code>.</li>
</ol>
</section>
<section id="faq" class="level2">
<h2>FAQ</h2>
<section id="what-do-the-columns-mean" class="level3">
<h3>What do the columns mean?</h3>
<ul>
<li>started_at: the scheduled game start time</li>
<li>away: The away team name</li>
<li>home: the home team name</li>
<li>method: The method used to build the <code>mvglmmRank</code> model; the default is “PB1”.</li>
<li>away_score_p: the projected score for the away team</li>
<li>home_score_p: the projected score for the home team</li>
<li>total_p: the projected total score</li>
<li>home_mov_p: the predicted home margin of victory (home score - away score)</li>
<li>home_prob_w: the predicted probability that the home team wins</li>
<li>away_prob_w: the predicted probability that the away team wins</li>
<li>entropy: the predicted Shannon entropy for the game</li>
</ul>
<p>This last column needs some explanation. The Shannon entropy is a measure of information - how much we stand to learn about the teams from the outcome of the game. It’s an indicator of closeness. The maximum value, 1.0, indicates that the game will be close and we’ll learn a lot from the outcome.</p>
<p>A minimum score, zero, indicates that the game will be a blowout. There’s little we can learn; they might as well just give the game to the favorite and avoid injury risk. ;-) I’ve never seen a zero; the lowest value of the entropy predictions for the upcoming NBA season as of December 25, 2017 is Hawks at Warriors, coming up on 2018-03-23, with a projected entropy of 0.39.</p>
</section>
<section id="how-good-are-the-projections" class="level3">
<h3>How good are the projections?</h3>
<p>They’re about as good as you can get considering that the only inputs they have are the scores of completed games. They won’t be as good as projectsions that take into account more detailed information from compeleted games. They won’t be as good as projections based on a simulation. And they won’t be as good as closing odds / point spreads / totals from bookmakers, which take into account late-breaking player status and the “wisdom of the crowd”.</p>
</section>
<section id="where-can-i-find-details-on-mvglmmrank" class="level3">
<h3>Where can I find details on <code>mvglmmRank</code>?</h3>
<p>The package documentation is at <span class="citation" data-cites="Karl2015">Karl and Broatch (2015)</span>, but there’s not a lot of the mathematics there. <span class="citation" data-cites="Broatch2017">Broatch and Karl (2017)</span> gives the math and references earlier papers with more details.</p>
</section>
</section>
<section id="references" class="level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Broatch2017">
<p>Broatch, Jennifer E., and Andrew T. Karl. 2017. “Multivariate Generalized Linear Mixed Models for Joint Estimation of Sporting Outcomes.” <a href="https://arxiv.org/abs/1710.05284" class="uri">https://arxiv.org/abs/1710.05284</a>.</p>
</div>
<div id="ref-Karl2015">
<p>Karl, Andrew T., and Jennifer Broatch. 2015. <em>MvglmmRank: Multivariate Generalized Linear Mixed Models for Ranking Sports Teams</em>. <a href="https://CRAN.R-project.org/package=mvglmmRank" class="uri">https://CRAN.R-project.org/package=mvglmmRank</a>.</p>
</div>
</div>
</section>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
